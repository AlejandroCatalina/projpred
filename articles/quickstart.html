<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>projpred Quick Start â€¢ projpred</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="projpred Quick Start">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">projpred</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="http://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="http://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/projpred/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>projpred Quick Start</h1>
            
            <h4 class="date">2018-04-25</h4>
      
      

    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{projpred quickstart guide}
\usepackage[utf8](inputenc)
-->
<p>This vignette shows how to use the main functionalities of the <code>projpred</code>-package, which implements the projective variable selection (Goutis and Robert, 1998; Dupuis and Robert, 2003) for generalized linear models fitted with <code>rstanarm</code>. The method is described and evaluated in comparison to many other methods in Piironen and Vehtari (2017a).</p>
<div id="gaussian-example" class="section level2">
<h2 class="hasAnchor">
<a href="#gaussian-example" class="anchor"></a>Gaussian example</h2>
<p>First load the packages that are needed, and specify the number of available cores (this speeds up the sampling when multiple cores are available). Uncomment the last line in the following commands (this is commented out to avoid possible problems when building the vignette along the package installation in special environments such as computing clusters).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rstanarm)
<span class="kw">library</span>(projpred)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(bayesplot)
<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/theme_get">theme_set</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>())
<span class="co">#options(mc.cores = parallel::detectCores())</span></code></pre></div>
<p>The package contains a simple Gaussian example dataset accessible with the <code>data</code>-command. This dataset is one of the example cases from the <code>glmnet</code>-package. The following command loads a dataframe <code>df_gaussian</code> with the predictor matrix <code>x</code> and the corresponding targets <code>y</code> into the workspace.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">'df_gaussian'</span>, <span class="dt">package =</span> <span class="st">'projpred'</span>)</code></pre></div>
<p>We then fit the model with all the variables and sparsifying horseshoe prior (Carvalho et al., 2010) on the regression coefficients. This gives us the full Bayesian solution to the problem. To specify the prior beliefs about the number of relevant variables, we use the framework discussed by Piironen and Vehtari (2017b,c), in which the prior for the global shrinkage parameter is defined based on our prior guess for the number of relevant variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(df_gaussian<span class="op">$</span>x) <span class="co"># 100</span>
D &lt;-<span class="st"> </span><span class="kw">ncol</span>(df_gaussian<span class="op">$</span>x) <span class="co"># 20</span>
p0 &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co"># prior guess for the number of relevant variables</span>
tau0 &lt;-<span class="st"> </span>p0<span class="op">/</span>(D<span class="op">-</span>p0) <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(n) <span class="co"># scale for tau (notice that stan_glm will automatically scale this by sigma)</span>
prior_coeff &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/rstanarm/topics/priors">hs</a></span>(<span class="dt">global_scale =</span> tau0, <span class="dt">slab_scale =</span> <span class="dv">1</span>) <span class="co"># regularized horseshoe prior</span>
fit &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/rstanarm/topics/stan_glm">stan_glm</a></span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">family=</span><span class="kw">gaussian</span>(), <span class="dt">data=</span>df_gaussian, <span class="dt">prior=</span>prior_coeff,
                <span class="co"># to make this vignette build fast, we use only 2 chains and</span>
                <span class="co"># 500 draws. In practice, more conservative values, eg. 4 chains</span>
                <span class="co"># and 2000 draws might be required for reliable inference.</span>
                <span class="dt">seed=</span><span class="dv">1</span>, <span class="dt">chains=</span><span class="dv">2</span>, <span class="dt">iter=</span><span class="dv">500</span>) </code></pre></div>
<p>The variable selection can then be excecuted with the command <code>varsel</code>. This will add a field <code>varsel</code> to the <code>fit</code>-object containing information about the variable selection, such as the ordering of the variables. The search heuristic can be specified by the keyword <code>method</code>. Currently the package implements forward search and Lasso type L1-penalization to find the variable ordering (Tran et al., 2012). The latter is much faster for large problems but the forward search can sometimes be more accurate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/varsel.html">varsel</a></span>(fit, <span class="dt">method=</span><span class="st">'forward'</span>)
fit<span class="op">$</span>varsel<span class="op">$</span>vind <span class="co"># variables ordered as they enter during the search</span></code></pre></div>
<pre><code>##  x1 x14 x20  x5  x3  x6  x8 x11 x13  x7 x10 x15 x12 x18  x4  x2 x16 x17 
##   1  14  20   5   3   6   8  11  13   7  10  15  12  18   4   2  16  17 
##  x9 x19 
##   9  19</code></pre>
<p>We can then plot some statistics computed on the training data, such as the sum of log predictive densities (ELPD) and root mean squared error (RMSE) as the function of number of variables added. By default, the statistics are shown on absolute scale, but with <code>deltas=T</code> the plot shows results relative to the full model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot predictive performance on training data </span>
<span class="kw"><a href="../reference/varsel-statistics.html">varsel_plot</a></span>(fit, <span class="dt">stats=</span><span class="kw">c</span>(<span class="st">'elpd'</span>, <span class="st">'rmse'</span>))</code></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>The statistics computed on the training data typically give us a rough idea of how many variables are needed in order to capture all the predictive power of the full model. However, because these statistics are computed using the same data that was used to fit the models, the results can be biased. More reliable assessment can be obtained by cross-validating both the full model and the variable selection process.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_cv &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cv_varsel.html">cv_varsel</a></span>(fit, <span class="dt">method=</span><span class="st">'forward'</span>)</code></pre></div>
<p>In this case the cross-validated results look quite similar to those computed on the training data, showing that after 6 or 7 variables the predictions do not change markedly. The model size suggested by the program is stored in the variable <code>ssize</code> in the field <code>varsel</code>, and it can be obtained also by calling function <code>suggest_size</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># model size suggested by the program</span>
<span class="kw"><a href="../reference/suggest_size.html">suggest_size</a></span>(fit_cv)</code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the validation results, this time relative to the full model</span>
<span class="kw"><a href="../reference/varsel-statistics.html">varsel_plot</a></span>(fit_cv, <span class="dt">stats =</span> <span class="kw">c</span>(<span class="st">'elpd'</span>, <span class="st">'rmse'</span>), <span class="dt">deltas=</span>T)</code></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>We can now perform the projection for a submodel of desired size using the function <code>project</code>. The projection can also be coerced to a matrix with draws of the selected variables and sigma. The draws can be visualized with e.g.Â the <code>mcmc_areas</code> function in the <code>bayesplot</code> package. Below we compare how the projection affects the three most relevant variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualise the three most relevant variables in the full model</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/bayesplot/topics/MCMC-intervals">mcmc_areas</a></span>(<span class="kw">as.matrix</span>(fit), 
           <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">'(Intercept)'</span>, <span class="kw">names</span>(fit<span class="op">$</span>varsel<span class="op">$</span>vind[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]), <span class="st">'sigma'</span>)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/coord_cartesian">coord_cartesian</a></span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>))</code></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualise the projected three most relevant variables</span>
proj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(fit, <span class="dt">nv =</span> <span class="dv">3</span>, <span class="dt">ns =</span> <span class="dv">500</span>)
<span class="kw"><a href="http://www.rdocumentation.org/packages/bayesplot/topics/MCMC-intervals">mcmc_areas</a></span>(<span class="kw">as.matrix</span>(proj)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/coord_cartesian">coord_cartesian</a></span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>))</code></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>We can also make predictions with the submodels using method <code>proj_linpred</code>. Test inputs can be provided using the keyword <code>xnew</code>. If also the test targets <code>ynew</code> are provided, then the function evaluates the log predictive density at these points. For instance, the following computes the mean of the predictive distribution and evaluates the log density at the training points using the 6 most relevant variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pred &lt;-<span class="st"> </span><span class="kw"><a href="../reference/proj-pred.html">proj_linpred</a></span>(fit, <span class="dt">xnew=</span>df_gaussian<span class="op">$</span>x, <span class="dt">ynew=</span>df_gaussian<span class="op">$</span>y, <span class="dt">nv =</span> <span class="dv">6</span>, <span class="dt">integrated =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Visualize the predictions</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>pred<span class="op">$</span>pred,<span class="dt">y=</span>df_gaussian<span class="op">$</span>y)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_abline</a></span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">color=</span><span class="st">'red'</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">'prediction'</span>, <span class="dt">y =</span> <span class="st">'y'</span>)</code></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
<div id="binomial-example-logistic-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#binomial-example-logistic-regression" class="anchor"></a>Binomial example (logistic regression)</h2>
<p>This section shows an example of the variable selection for a logistic regression model (binary classification). Everything is very similar to the Gaussian case. First load the data (this dataset is also from the <code>glmnet</code>-package):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">'df_binom'</span>, <span class="dt">package =</span> <span class="st">'projpred'</span>)</code></pre></div>
<p>Then fit the full model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># fit the full model</span>
n &lt;-<span class="st"> </span><span class="kw">nrow</span>(df_binom<span class="op">$</span>x)
D &lt;-<span class="st"> </span><span class="kw">ncol</span>(df_binom<span class="op">$</span>x)
p0 &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co"># prior guess for the number of relevant variables</span>
sigma &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># approximate plug-in value for observation information (Piironen and Vehtari, 2017b)</span>
tau0 &lt;-<span class="st"> </span>p0<span class="op">/</span>(D<span class="op">-</span>p0) <span class="op">*</span><span class="st"> </span>sigma<span class="op">/</span><span class="kw">sqrt</span>(n)
prior_coeff &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/rstanarm/topics/priors">hs</a></span>(<span class="dt">global_scale =</span> tau0, <span class="dt">slab_scale =</span> <span class="dv">1</span>)
fit &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/rstanarm/topics/stan_glm">stan_glm</a></span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">family=</span><span class="kw">binomial</span>(), <span class="dt">data=</span>df_binom, <span class="dt">prior=</span>prior_coeff,
                <span class="dt">seed=</span><span class="dv">1</span>, <span class="dt">chains=</span><span class="dv">2</span>, <span class="dt">iter=</span><span class="dv">500</span>)</code></pre></div>
<p>Run the variable selection and print out the variable ordering</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/varsel.html">varsel</a></span>(fit, <span class="dt">method=</span><span class="st">'forward'</span>)
fit<span class="op">$</span>varsel<span class="op">$</span>vind</code></pre></div>
<pre><code>##  x4 x10 x25  x6  x2  x9  x3  x8 x16 x26 x28 x29  x5 x23 x22 x30 x11  x1 
##   4  10  25   6   2   9   3   8  16  26  28  29   5  23  22  30  11   1 
## x27 x18 
##  27  18</code></pre>
<p>Plot the ELPD and classification accuracy on the training data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/varsel-statistics.html">varsel_plot</a></span>(fit, <span class="dt">stats=</span><span class="kw">c</span>(<span class="st">'elpd'</span>, <span class="st">'acc'</span>), <span class="dt">deltas=</span>F)</code></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<p>Cross-validate the full model and the variable selection:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_cv &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cv_varsel.html">cv_varsel</a></span>(fit, <span class="dt">method=</span><span class="st">'forward'</span>)</code></pre></div>
<p>Plot the cross-validated performance estimates for the submodels relative to the full model. In this case the cross-validated results differ from the training statistics especially for model sizes 3 to 7 varibles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># model size suggested by the program</span>
<span class="kw"><a href="../reference/suggest_size.html">suggest_size</a></span>(fit_cv)</code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the validation results</span>
<span class="kw"><a href="../reference/varsel-statistics.html">varsel_plot</a></span>(fit_cv, <span class="dt">stats=</span><span class="kw">c</span>(<span class="st">'elpd'</span>, <span class="st">'acc'</span>), <span class="dt">deltas=</span>T)</code></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<p>Finally, for illustration, we compute here the predictive class probabilities using only the two most relevant variables, and visualize the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># evaluate the predictive distribution in a 2d grid</span>
ng &lt;-<span class="st"> </span><span class="dv">20</span>
x1g &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="dt">len=</span>ng)
x2g &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="dt">len=</span>ng)
xnew &lt;-<span class="st"> </span><span class="kw">cbind</span>( <span class="kw">rep</span>(x1g,<span class="dt">each=</span>ng), <span class="kw">rep</span>(x2g,ng) )
vind &lt;-<span class="st"> </span>fit<span class="op">$</span>varsel<span class="op">$</span>vind[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]
pr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/proj-pred.html">proj_linpred</a></span>(fit, xnew, <span class="dt">vind=</span>vind, <span class="dt">transform=</span>T, <span class="dt">integrated=</span>T)

<span class="co"># visualize the contours showing the predicted class probabilities</span>
pp &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>()
pp &lt;-<span class="st"> </span>pp <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_contour">geom_contour</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>xnew[,<span class="dv">1</span>],<span class="dt">y=</span>xnew[,<span class="dv">2</span>], <span class="dt">z=</span>pr, <span class="dt">colour=</span>..level..))
pp &lt;-<span class="st"> </span>pp <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_gradient">scale_colour_gradient</a></span>(<span class="dt">low =</span> <span class="st">"red"</span>, <span class="dt">high =</span> <span class="st">"green"</span>)
pp &lt;-<span class="st"> </span>pp <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>df_binom<span class="op">$</span>x[,vind[<span class="dv">1</span>]],<span class="dt">y=</span>df_binom<span class="op">$</span>x[,vind[<span class="dv">2</span>]]), <span class="dt">color=</span>df_binom<span class="op">$</span>y<span class="op">+</span><span class="dv">2</span>)
pp &lt;-<span class="st"> </span>pp <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">xlab</a></span>(<span class="kw">sprintf</span>(<span class="st">'Feature %d'</span>,vind[<span class="dv">1</span>])) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">ylab</a></span>(<span class="kw">sprintf</span>(<span class="st">'Feature %d'</span>,vind[<span class="dv">2</span>]))
pp</code></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<div id="references" class="section level3">
<h3 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h3>
<p>Carvalho, C.M., Polson, N.G., Scott, J.G. (2010). The horseshoe estimator for sparse signals. <em>Biometrika</em> 97(2):465â€“480.</p>
<p>Dupuis, J. A. and Robert, C. P. (2003). Variable selection in qualitative models via an entropic explanatory power. <em>Journal of Statistical Planning and Inference</em>, 111(1-2):77â€“94.</p>
<p>Goutis, C. and Robert, C. P. (1998). <em>Model choice in generalised linear models: a Bayesian approach via Kullbackâ€“Leibler projections</em>. Biometrika, 85(1):29â€“37.</p>
<p>Piironen, Juho and Vehtari, Aki (2017a). Comparison of Bayesian predictive methods for model selection. <em>Statistics and Computing</em> 27(3):711-735. DOI 10.1007/s11222-016-9649-y. <a href="http://link.springer.com/article/10.1007/s11222-016-9649-y">Online</a></p>
<p>Piironen, Juho and Vehtari, Aki (2017b). On the Hyperprior Choice for the Global Shrinkage Parameter in the Horseshoe Prior. In <em>Proceedings of the 20th International Conference on Artificial Intelligence and Statistics (AISTATS)</em>, PMLR 54:905-913, 2017. <a href="http://proceedings.mlr.press/v54/piironen17a.html">Online</a></p>
<p>Piironen, Juho and Vehtari, Aki (2017c). Sparsity information and regularization in the horseshoe and other shrinkage priors. <em>Electronic Journal of Statistics</em>, 11(2): 5018â€“5051. <a href="https://projecteuclid.org/euclid.ejs/1513306866#info">Online</a></p>
<p>Tran, M.N., Nott, D.J., Leng, C. (2012): The predictive Lasso. <em>Statistics and Computing</em> 22(5):1069-1084.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#gaussian-example">Gaussian example</a></li>
      <li><a href="#binomial-example-logistic-regression">Binomial example (logistic regression)</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Markus Paasiniemi, Juho Piironen, Aki Vehtari.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
